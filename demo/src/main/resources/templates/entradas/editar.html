<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>

    <title>Editar Entrada</title>

    <!-- FAVICON -->
    <link rel="icon" type="image/png" href="/img/icons8-coser-16.png"/>

    <!-- Custom fonts -->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,300,400,600,700,900" rel="stylesheet"/>

    <!-- Template CSS -->
    <link href="css/sb-admin-2.min.css" rel="stylesheet"/>

    <!-- CSS personalizado -->
    <link rel="stylesheet" href="css/dashboard.css"/>
    <link rel="stylesheet" href="css/entrada-add.css"/>

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- CSRF -->
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
</head>

<body id="page-top">

<div id="wrapper">
    <div layout:fragment="content">

        <div class="container-fluid">

            <!-- Título -->
            <div class="d-sm-flex align-items-center justify-content-between mb-2">
                <h1 class="h3 mb-0 text-gray-800">Editar Entrada</h1>
                <a th:href="@{/entradas}" class="btn btn-secondary btn-icon-split">
                    <span class="icon text-white-50">
                        <i class="fas fa-arrow-left"></i>
                    </span>
                    <span class="text">Volver</span>
                </a>
            </div>

            <p class="mb-3">
                Completa los campos con la información de la entrada y sus insumos.
            </p>

            <!-- FORMULARIO -->
            <form id="formEntrada" class="needs-validation" novalidate>

                <!-- SECCIÓN 1: INSUMOS -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">Selección de Insumos</h6>
                    </div>

                    <div class="card-body">
                        <div class="row g-3">

                            <!-- Búsqueda de insumo -->
                            <div class="col-md-5 position-relative">
                                <label for="nombre" class="form-label">Nombre del insumo</label>
                                <input type="text" id="nombre" class="form-control" placeholder="Buscar insumo..." autocomplete="off"/>
                                <input type="hidden" id="insumoIdSeleccionado"/>

                                <div id="sugerencias" class="list-group position-absolute w-100 z-index-1000"></div>
                            </div>

                            <!-- Cantidad -->
                            <div class="col-md-4">
                                <label class="form-label required">Cantidad</label>
                                <input type="number" id="cantidad" class="form-control" min="0" step="5"/>
                                <div class="invalid-feedback">Ingrese una cantidad válida.</div>
                            </div>

                            <!-- Botón agregar -->
                            <div class="col-md-2 d-flex align-items-end">
                                <button type="button" id="btnAgregarInsumo" class="btn btn-primary btn-block">
                                    <i class="fas fa-plus mr-1"></i> Agregar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECCIÓN 2: LISTA DE INSUMOS -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">Lista de Insumos</h6>
                    </div>

                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Cantidad</th>
                                    <th>Acciones</th>
                                </tr>
                                </thead>
                                <tbody id="tabla-insumos"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- SECCIÓN 3: DATOS GENERALES -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">Información General</h6>
                    </div>

                    <div class="card-body">
                        <div class="row g-3">

                            <!-- Fecha -->
                            <div class="col-md-4">
                                <label for="fecha" class="form-label required">Fecha</label>
                                <input type="date" id="fecha" class="form-control" required/>
                                <div class="invalid-feedback">Seleccione una fecha.</div>
                            </div>

                            <!-- Proveedor -->
                            <div class="col-md-7">
                                <label for="proveedor" class="form-label required">Proveedor</label>
                                <select id="proveedor" class="form-control" required>
                                    <option value="">-- Selecciona un proveedor --</option>
                                </select>
                                <div class="invalid-feedback">Seleccione un proveedor.</div>
                            </div>
                        </div>

                        <!-- Descripción -->
                        <div class="col-12 mt-3">
                            <label for="descripcion" class="form-label">Descripción</label>
                            <textarea id="descripcion" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                </div>

                <!-- BOTONES -->
                <div class="d-flex justify-content-end mb-4">
                    <button type="button" id="btnLimpiar" class="btn btn-outline-secondary mr-2">
                        <i class="fas fa-eraser mr-1"></i> Limpiar
                    </button>

                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save mr-1"></i> Guardar entrada
                    </button>
                </div>

            </form>

        </div>
    </div>
</div>

<div layout:fragment="scripts">

    <!-- jQuery / Bootstrap -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Template -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <script src="js/sb-admin-2.min.js"></script>

    <!-- Script de la página -->
    <script src="/js/editar-entrada.js"></script>

</div>

</body>
</html>
